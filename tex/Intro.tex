\graphicspath{ {img/SPEC_MAN/} }
\chapter{Introduction}
\section{Motivation}
Wireless communications need, among other resources, radio-electric spectrum, which is finite. 
Government agencies, such as the FCC in the United States or the Electronic Communications Committee (ECC) through national administrations in Europe, grant access to it through fixed, long-term licenses on large geographical areas, in what is called the "command-and-control" management scheme. 
Licenses were given to operators in national lotteries and comparative hearings first, and later through spectrum auctions. % Al principio, de hecho, las concedian en un first-come-first-served. Cuando la demanda creció, loterias y concursos. Finalmente, por aquello de que parece un procedimiento menos manipulable, las subastas.
Nevertheless, the ever-growing demand of spectrum due to the popularization of mobile services has left these traditional policies obsolete since almost all the spectrum has already been assigned. % Add figure (the typical with the spectrum assignments).

However, several reports have been pointing out that most of the licensed spectrum show very little use. In 2002, the FCC Spectrum Policy Task Force \cite{ref:FCC2002} highlighted that typical channel occupancy of some public safety community, for example, could be less than 15\%. The European Commission, in 2007, also stated that "some users hold large amounts of valuable spectrum that they do not use to its full capacity" \cite{ref:Commission2007}.

From early on, experts suggested \cite{ref:Valletti2001} it would be necessary to switch to a more flexible management to improve spectrum efficiency. In the US, the FCC started allowing license holders to lease their licenses under different constraints in 2003 \cite{ref:Mayo2010}, whereas in Europe is taking some more time: by 2011, only 9 out of 22 european countries surveyed by the Electronic Communications Committee (ECC) allowed spectrum leasing \cite{ref:ECC2011}. %OJO a la referencia a Mayo, explicitar a que estamos linkando mejor (no a ninguna ley de 2003).
%¿Cual es la situacion actual en cuanto a regulacion y por que? Chequear:
% - "Enabling efficient wireless communications..."(2010,paper)
% - "The Spectrum Handbook" (2013, book)
% - "Cognitive Radio Policy and Regulation: Techno-Economic Studies to Facilitate Dynamic Spectrum Access (Signals and Communication Technology" (2014, book)
% - "Digital Crossroads: Telecommunications Law and Policy in the Internet Age" (2013, book)
% - Web del Horizonte2020

Cognitive radios \cite{ref:Mitola1999} could elasticize spectrum management even further by enabling the automatic exploitation of unused spectrum opportunities anywhere in time, space, frequency, power and/or in CDMA codes.
A \emph{cognitive radio} has two main characteristics \cite{ref:Akyildiz2006}: cognitive capability and reconfigurability. 
Cognitive capability refers to the ability of the radio to become aware of its surrounding radio environment. Reconfigurability refers to the ability of the radio of changing its transmission parameters dynamically.
% Añadir la tipica figura de los huecos.

In the most typical scenario, secondary users (SUs, unlicensed), equipped with cognitive radios, would look for unused fragments of spectrum and would use them for their transmissions subject to interference constraints for the protection of primary users (PUs, licensed). 
This situation corresponds to the “Hierarchical Access Model”, also known as "Opportunistic Spectrum Access", one of the possible coexistence approaches under “Dynamic Spectrum Access” (DSA) but there are others \cite{ref:Zhao2007_sur}. 
Along the lines of current regulation models is the “Dynamic Exclusive Use Model”, which considers leasing or selling licenses but at a smaller time-scale, even real-time and free choice of technology.
Lastly, the “Spectrum Commons Model”  assumes open sharing with no categories of users.
% ¿Añadir grafico con los tipos de modelos?

DSA has recently gained popularity because of the TV digitalization, in order to take advantage of the spectrum opportunities it has generated. % Añadir año. Explicar que se libera espectro procedente de las teles analogicas pero se nombra a algunos usuarios particulares como primarios.
Therefore, the last few years have seen some DSA standards such as IEEE 802.22 [9], ECMA-392 [10], 802.11af [12], 802.19.1 [11] and IEEE SCC41 [13].

No matter which model is considered, spectrum sharing can annoy licensed operators at present, because it may imply additional costs to them such as changes in their infrastructures, QoS impairments due to interferences or profit reduction due to increased competition, while they have already paid for their licenses. 
Protecting and creating incentives for PUs instead of forcing them avoids that actual spectrum owners as well as prospective ones feel discouraged from investing in new spectrum technologies and services: "why am I going to spend money in spectrum if the government is going to give it for free to others?".

Therefore, it is needed that these operators believe in an automated mechanism that controls their profits. But this idea alone is scary. "Is there any security on obtaining benefit"? It is hard to convince the telecommunications industry to adopt automated dynamic spectrum management mechanisms if there is no strong evidence that these algorithms do not lead to economic loses (due to disadaptation to real time, for example). Optimality, then, remains in the background.

Our\footnote{I will be using the first person plural voice by default throughout my thesis. Most of the ideas and work is a team effort involving my supervisor and other authors. This should not be detrimental of showing off my autonomy, but even my personal decisions where strongly inspired by others' opinions. Meaningful research is not done (should not be done) by a single person in a vacuum. Thus, I consider artificial the use of "I" here. In other parts of this work, such first person plural will also include the reader, primarily when describing mathematical derivations, as a natural way of walking him through the process.} \emph{motivation} in this thesis is, therefore, \emph{to develop dynamic spectrum access mechanisms with a strong focus on the protection and creation of incentives to the PUs.} 
On the other hand, secondary users also need an incentive to request spectrum from the primary operator (\textit{e.g.} customized tariffs). Otherwise, the approach will not work because they would all prefer to become primary users.

In addition, the main tendency of previous (and contemporaneous) solutions in the area has been building increasingly complex models, which deal with more issues of spectrum in more convoluted scenarios, and aiming to solve them optimally. 
Nonetheless, the resources required to reach such elaborated solutions have not been considered enough, specially time. Time consumption is a relevant issue because, as we have been pointing out throughout our survey, multiple important parameters in spectrum trading experience rapid variations over time: spectrum opportunities, demand (unplanned peaks of traffic), valuation of the spectrum (changes in channel gains, mobility of entities), etc.
In consequence, we think that \emph{time consumption should be regarded as a key feature in spectrum management algorithms}: if obtaining an optimal solution takes so long that the system’s parameters vary significantly during the computation time, this solution will be not optimal when applied. In addition, the more time devoted to negotiation among the agents, the less time used in transmission. For that reason, it is more practical to design models that may not fully exploit spectrum in a particular moment (for example, by not taking into account spectrum geographical reuse) but that are capable of reducing the uncertainty due to the changes over time, and thus, providing higher guarantees on the agents’ satisfaction. 

% OSA 
% Para unos existe solo underlay y overlay (Zhao2007) y para otros interweave, underlay y overlay (Heng2012).

% SPECTRUM TRADING
% Among all mechanisms proposed to improve spectrum efficiency such as forced resource allocation algorithms, automated spectrum trading has the advantage of providing economic (and/or other) incentives to the entities involved, especially important to licensed operators, encouraging their cooperation and promoting motivation for future investments in primary spectrum acquisitions.

% Previous works in economic theory are not easily translated to spectrum trading because of the specific features of the traded good. A spectrum market poses the following addi- tional challenges:
% – Rapid variations with time
% – Imperfect information
% – Complex resource allocation considering re-utilization
% and heterogeneity of the good
% Both spectrum supply and demand changes are related to data traffic intensity which, in general, experiences rapid variations with time. In addition, spectrum characteristics are also highly variable, in particular, availability and channel quality parameters. This implies that the agents making the decisions in the spectrum markets have to be algorithmic. Automatic transactions are present in financial trading ([14]), but that market does not show the specific issues of spectrum trading.
% Imperfect information not only refers to the competitive behavior of agents in a traditional market, by which they are not willing to reveal their true valuation of a good. It also refers to the fact that agents may not have complete or reliable information about the market due to the communi- cation complexity that it would involve, specially in ad-hoc
% networks. It entails unfeasible requirements such as, for ex- ample, all entities knowing all channel gains between each other.
% Resource allocation becomes more complicated with spec- trum as a traded good because, depending on the mutual in- terference ranges of the entities, it can be spatially reused. It may also be considered that spectrum is an heterogeneous good, in the sense that the same spectrum portion can be valuated differently by each user, depending on its position, technology (spectrum efficiency use), etc.
% Rapid variations with time and resource allocation in complex models are tightly interrelated. Optimal resource allocation in complex models requires a computational time that makes it hard to keep up with the rapid changes, which, in turn, may render a solution inefficient because of a time dis-adaptation. Dealing with imperfect information makes optimal resource allocation more complex, even intractable. On the contrary, local estimations could be considered, sac- rificing model optimality for the sake of speed.

% OTROS
% ¿Por que consideramos siempre single radios?
% Regarding the field of applicability, we are focused on the issues at the link-layer of cognitive networks. 
% Incomplete information scenarios: those for which some of the parameters of its stochastic models are not known or are not stationary. 


\section{Contributions and thesis structure}

Our contribution can be divided into two main blocks, coincident with the structure of the thesis. 
Part \ref{part_OSA} features our works in the field of Opportunistic Spectrum Access. 
These works are focused on protecting the PUs from interference caused by SUs access to spectrum, while trying to increase the spectrum usage efficiency. 
The most common approach in previous literature is to study the sensing and access from the SUs perspective, that is, the algorithms the SUs follow (independently if the works are addressing the impact on PUs or on SUs). Conceptually, cognitive radios, especially when used under an OSA approach, is to use the cognitive capabilities of these users to make their access transparent (or as transaparent as possible) to the PUs. 
However, our works introduce the novel approach of giving more power to the PU: they focus on PU spectrum management strategies. More specifically:
\begin{itemize}
\item Chapter \ref{BD_chap}: Background Detection of Primary User Activity in Opportunistic Spectrum Access. 
We propose a collision detection mechanism for the SU, simultaneous to packet reception. 
Our proposal exploits local characterization of the PU activity, power levels and packet errors at each time slot. 
Based on these data, we develop a Maximum \textit{A Posteriori} (MAP) estimator as the basis for the collision detection system. We describe the general methodology to build this estimator, and study the system's robustness against parameter misestimations. 
The proposed scheme can be incorporated to existing OSA protocols. 
Our results show a notable throughput improvement for the SUs while assuring a lower collision probability with PU transmissions in most cases, even under severe estimation inaccuracies.

\bibentry{ref:Alcaraz2015_BD}

\item Chapter \ref{BR_chap}: Bandwidth Reservation as a Coexistence Strategy in Opportunistic Spectrum Access Environments. We study a bandwidth reservation (BR) scheme by which the PN keeps a set of adjacent channels free of PU transmissions. 
These reserved channels only accommodate PU traffic when all the non-reserved channels are used, and the SUs only occupy available channels within the reserved spectrum.
From the point of view of the PN, BR entails a tradeoff between the benefits of an improved coexistence with SUs, and the capacity reduction associated to having fewer options for PU channel allocation.
The SUs are characterized by a hardware limited radio, imperfect spectrum sensing, bayesian estimation of PU activity and multichannel access. 
By means of a Markov-reward model, we compute the expected PU capacity with and without BR, considering propagation effects, interference and random locations.
The results show that, in a non-congested PN with SU activity, the interference reduction capability of BR increases the overall capacity of the PN compared to not using BR.

\bibentry{ref:Alcaraz2014_BR}
\item Chapter \ref{SPEC_MAN_chap}: On the Impact of Licensed Users Management on the Efficiency of Opportunistic Spectrum Access.
The main contribution of this work is to evaluate resource management strategies for licensed users that are intuitively more suitable for coexistence with OSA nodes, but not implying a direct cooperation with them.
We also develop an OSA policy optimization procedure handling partial and unreliable spectrum observations at the SUs.
The formulation combines SU throughput and PU performance degradation, characterized by the overlapping time with SU activity which is a more general parameter than collision probability.    
Although it may raise some concerns about the robustness of this approach, our results show that estimation inaccuracies have a very small effect on the quality of service attained by the PUs.

\bibentry{ref:Alcaraz2015_SPEC_MAN}
\item Chapter \ref{RSM_chap}. Response Surface Methodology for Efficient Spectrum Reuse in Cellular Networks.
As cellular network technology evolves, the operators deploy new generation networks while maintaining their legacy networks, since not all users upgrade their terminals at the same pace.
Therefore, the spectrum associated to these legacy networks becomes gradually underused.
By means of cognitive radio techniques, the operator can allow its new generation terminals to reuse this spectrum.
We propose a semi-decentralized scheme in which a cellular operator guides the secondary access by broadcasting some operational parameters of the access strategy.
The mechanism dynamically learns the optimal parameters by means of a response surface methodology (RSM), implying a very small signalling overhead.
Our results show a notable capacity improvement compared to the classical approaches of exploiting spatial or temporal opportunities.
\end{itemize}  
\bibentry{ref:Alcaraz2014_RSM}
\bibentry{ref:Alcaraz2015_RSM}
Part \ref{part_auto} of the thesis contains those works in the field of automated spectrum trading. 
It is especially in this part where the our low-complexity-intention has a greater significance, since most previous works are dealing with great convoluted markets and neglecting the importance of real-time adaptation, as our survey in chapter \ref{Survey_chap} shows. 
Our contribution in this topic can be summarized as follows:
\begin{itemize}
\item Chapter \ref{Survey_chap}. Automated spectrum trading mechanisms: understanding the big picture.
This work presents a general view of automated spectrum trading.
Our work is unique in its scope, focusing on automated spectrum trading as the most promising mechanism to solve spectrum scarcity.
We identify the specific aspects that make spectrum different from conventional goods and the impact that these features have on automatic trading.
We discuss past, current approaches and future research lines, highlighting their advantages and disadvantages. 
Each sub-topic is presented and developed explicitly with references to previous works where each aspect has been considered or addressed.
Finally, as a conclusion of the surveying effort, we highlight overlooked issues of automated spectrum trading, with a special focus on practical implementation.
\bibentry{ref:Mario2014}
\item Chapter \ref{Sarnoff_chap} An MDP Framework for Centralized Dynamic Spectrum Auction.
This work addresses the design of centralized DSA MAC protocols comprising dynamic spectrum auction. We explore the possibilities of a formal design based on a Markov decision process (MDP) formulation. We propose a design framework to balance the grade-of-service (given by the blocking probability for LUs) and the expected economic revenue provided by the SUs' accepted bids. 
This trade-off can be managed in two ways. One consists of computing a single objective value given by a combination of the blocking probability and the expected revenue. 
The weights assigned to each objective determine the point in the Pareto front where the obtained policy lies. The other approach, consists of solving for one of the objectives and setting constraints on the remaining ones.
Our paper focuses on centralized trading in which we explore the use of MDP and CMDP formulations to balance benefit and grade of service for LUs. 
The main advantages of this approach is that it assures operating at global optimum and reduces the computational effort at SUs.
\bibentry{ref:Alcaraz2012}
\item Chapter \ref{MAB_CSSA_chap}. A superprocess with Upper Confidence Bounds for Cooperative Spectrum Sharing. In this last work we focus on Cooperative Spectrum Sharing (CSS). CSS is is an appealing approach for primary users (PUs) to share spectrum with secondary users (SUs) because it increases the transmission range or rate of the PUs. Most previous works are focused on developing complex algorithms which may not be fast enough for real-time variations such as channel availability and/or assume perfect information about the network. Instead, we develop a learning mechanism for a PU to enable CSS in a strongly incomplete information scenario with low computational overhead. Our mechanism is based on a Markovian variant of multi-armed bandits (MABs) called superprocess, enhanced with the concept of Upper Confidence Bound (UCB) from stochastic MABs. By means of Monte-Carlo simulations we show that, despite its low computational overhead, it converges to the optimal solution and outperforms previous approaches such as $\epsilon$-greedy. This algorithm can be extended to include more sophisticated features while maintaining its desirable properties such as low computational overhead and fast speed of convergence. 
\end{itemize}
\bibentry{ref:Mario2015_MAB_CSSA_1}
\bibentry{ref:Mario2015_MAB_CSSA_2}

\section{Methodology}
This thesis is part of the project “ChAracterization, EvaLuation, Planning and IMprovement of Key Technologies for the Future Internet: Knowledge and Transfer (CALM), funded by the Spanish Ministry of Economy and Competitiveness. The CALM project is organized as a set of objectives interrelating key technologies for the Future Internet, \emph{with a special focus on mathematical tools} for the development, analysis and improvement of networks and protocols.

Most of our proposed coexistence mechanisms and policies in this thesis are grounded in Markov Decision Processes (MDPs) \cite{ref:Puterman2005}. The suitability of this tool for our scenario is straightforward to see: Markov models "are applicable to any dynamic system whose evolution over time involves uncertainty" \cite{ref:Bertsekas}, as it happens with the spectrum occupancy over time. The constrained-MDP (CMDP) used in chapter \ref{Sarnoff_chap} and the MDP formulated in chapter \ref{SPEC_MAN_chap}, derived from a Continuous Time Markov Chain (CTMC), are especially remarkable because of their far from common applicability in coexistence scenarios.  

Trying to characterize incomplete information scenarios, taking into account all the possible values of the unknown parameters is computationally infeasible with MDPs, effect known as "the curse of dimensionality" [CITE SUTTON AND BARTO or similar]. 
In the chapters devoted to dealing with incomplete information, we focus on the development on-line learning algorithms, employing tools like statistical inference (chapter \ref{BD_chap}) and reinforcement learning approaches (chapters \ref{Survey_chap},\ref{RSM_chap},\ref{MAB_CSSA_chap}). Some of these tools like Response Surface Methodology (RSM) (chapter \ref{RSM_chap}) or Multi-Armed bandits (MABs) (chapter \ref{MAB_CSSA_chap}) are of new applicability to coexistence issues in cognitive radio and are becoming hot topics, not only in the research community [CITATION] but also outside of it [CITATION].

Regarding the analysis and numerical evaluation of our mechanisms, Markov reward processes were used, mainly in their discrete form as Discrete Time Markov Chains (DTMC). Either accompanying the previous tool or as the main performance evaluation resource, we resorted to the simple but powerful concept of Monte-Carlo simulation [CITATION] [DEEPER EXPLANATION]. 

We rely on well-known stochastic models of the different real world parameters of interest, such as the Poisson model as traffic generation model, the log-normal distribution to describe shadow fading, etc. Such models have been widely used and validated in previous literature \cite{ref:Goldsmith2}
\begin{table}.
\begin{tabular}{|m{5cm}|H{3.5cm}|H{3.5cm}|} \hline
& \textbf{Tools used by proposed mechanisms} & \textbf{Numerical Evaluation}\\\hline
Background Detection of Primary User Activity in Opportunistic Spectrum Access & Statistical inference,\newline MDP & DTMC,\newline Monte-Carlo sim.\\\hline
Bandwidth Reservation as a Coexistence Strategy in Opportunistic Spectrum Access Environments & - & Stochastic model, DTMC, Monte-Carlo sim.\\\hline
On the Impact of Licensed Users Management on the Efficiency of Opportunistic Spectrum Access
 & MDP (from a CTMC) & DTMC \\\hline
Response Surface Methodology for Efficient Spectrum Reuse in Cellular Networks & Reinforcement learning (RSM) & MC sim.\\\hline
An MDP Framework for Centralized Dynamic Spectrum Auction & CMDP & DTMC \\\hline
A superprocess with Upper Confidence Bounds for Cooperative Spectrum Sharing & Reinforcement learning (MABs),\newline MDP & Monte-Carlo sim. \\\hline
\end{tabular}
\centering
\caption{Relation of mathematical tools and thesis chapters}
\label{intro_table_math_tools}
\end{table}


Because of our focus in algorithms and the link layer of cognitive networks, a characterization involving a full-protocol stack or a deep modeling of physical effects is not needed. Therefore, regarding the software support, we mainly worked with MATLAB [CITE], Mathematica [CITE] for mathematical derivations, and the OMNET simulator [CITE] in the particular case of chapter \ref{BR_chap} (used for numerical evaluation). We have also employed other development platforms such as Python with SciPy [CITE] and R, because of its great community support and because they are open source.



