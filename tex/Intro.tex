\graphicspath{ {img/SPEC_MAN/} }
\chapter{Introduction}
\section{Why Coexistence Policies?}
Wireless communications need, among other resources, radio-electric spectrum, which is finite. 
Government agencies, such as the FCC in the United States or the Electronic Communications Committee (ECC) through national administrations in Europe, grant access to the spectrum through fixed, long-term licenses on large geographical areas, in what is called the \enquote{command-and-control} management scheme. 
Licenses were given to operators in a first-come-first-served basis initially. As the demand of spectrum grew, the procedure changed to national lotteries and comparative hearings. Nowadays, licenses are granted through spectrum auctions generating large revenues to the public administration. %Por aquello de que parece un procedimiento menos manipulable.
Nevertheless, the ever-growing demand of spectrum due to the popularization of mobile services has left these traditional policies obsolete since almost all the spectrum has already been assigned. % Add figure (the typical with the spectrum assignments).

However, several reports have been pointing out that most of the licensed spectrum show very little use. In 2002, the FCC Spectrum Policy Task Force highlighted that the typical channel occupancy of a public safety community, for example, could be less than 15\% \cite{ref:FCC2002}. The European Commission, in 2007, also stated that \enquote{some users hold large amounts of valuable spectrum that they do not use to its full capacity} \cite{ref:Commission2007}.

From early on, experts suggested it would be necessary to switch to a more flexible management to improve spectrum efficiency \cite{ref:Valletti2001}. In the US, the FCC started allowing license holders to lease their licenses under different constraints in 2003 \cite{ref:Mayo2010}, whereas in Europe is taking some more time: by 2011, only 9 out of 22 european countries surveyed by the ECC allowed spectrum leasing \cite{ref:ECC2011}. %OJO a la referencia a Mayo, explicitar a que estamos linkando mejor (no a ninguna ley de 2003).
%¿Cual es la situacion actual en cuanto a regulacion y por que? Chequear:
% - "Enabling efficient wireless communications..."(2010,paper)
% - "The Spectrum Handbook" (2013, book)
% - "Cognitive Radio Policy and Regulation: Techno-Economic Studies to Facilitate Dynamic Spectrum Access (Signals and Communication Technology" (2014, book)
% - "Digital Crossroads: Telecommunications Law and Policy in the Internet Age" (2013, book)
% - Web del Horizonte2020

Cognitive radios \cite{ref:Mitola1999} could elasticize spectrum management even further by enabling the automatic exploitation of unused spectrum opportunities anywhere in time, space, frequency, power and/or in CDMA codes.
A \emph{cognitive radio} has two main characteristics \cite{ref:Akyildiz2006}: cognitive capability and reconfigurability. 
Cognitive capability refers to the ability of the radio to become aware of its surrounding radio environment. Reconfigurability refers to the device's ability of changing its transmission parameters dynamically.
% Añadir la tipica figura de los huecos.

In the most typical scenario, secondary users (SUs, unlicensed), equipped with cognitive radios, would look for unused fragments of spectrum in licensed bands and would use them for their transmissions subject to interference constraints for the protection of primary users (PUs, licensed). That is, PUs and SUs will coexist in some areas.
This situation corresponds to the “Hierarchical Access Model”, also known as \emph{Opportunistic Spectrum Access (OSA)}, one of the possible coexistence approaches under \emph{Dynamic Spectrum Access (DSA)} \cite{ref:Zhao2007_sur}. 
Along the lines of current regulation models is the Dynamic Exclusive Use Model, also called \emph{spectrum trading}, which considers leasing or selling licenses but at a smaller time-scale, even in a real-time basis and with a free choice of technology.
Lastly, the “Spectrum Commons Model”  assumes open sharing with no categories of users.
% ¿Añadir grafico con los tipos de modelos?

DSA has recently gained popularity because of the TV digitalization, in order to take advantage of the spectrum opportunities it has generated. % Añadir año. Explicar que se libera espectro procedente de las teles analogicas pero se nombra a algunos usuarios particulares como primarios.
Therefore, the last few years have seen some DSA standards such as IEEE 802.22 [9], ECMA-392 [10], 802.11af [12], 802.19.1 [11] and IEEE SCC41 [13].

No matter which model is considered, DSA is still annoying licensed operators at present, because it implies additional costs to them such as changes in their infrastructures, QoS impairments due to interferences, or profit reduction due to increased competition, while they have already paid for their licenses.
Protecting and creating incentives for PUs instead of forcing them avoids that actual spectrum owners, as well as prospective ones, feel discouraged from investing in new spectrum technologies and services: \enquote{why am I going to spend money in spectrum if the government is going to give it for free to others?}.

It is needed that these operators believe in an automated mechanism that controls their profits. But this idea alone is scary: \enquote{How big is the risk of experiencing a great economic loss?}. Especially if they take into account incidents like the one experienced in 2012 by the Knight Capital Group in the related
field of High Frequency Trading of stocks \cite{web:Silver2012} where the firm's algorithms caused a loss of \$440 million in 30 minutes (four times its net income from 2011).

It is hard to convince the telecommunications industry to adopt automated dynamic spectrum management mechanisms if there is no strong evidence that these algorithms are safe againist wrong decisions (due to disadaptation to real time, for example). We believe that optimality, then, should be considered as a secondary objective.

\section{Motivation and Objective}

As discussed in the previous section, while DSA has been widely accepted as the most promising approach to address the spectrum inefficiency problem, there are still some concerns that hinder its fully adoption by the telecom industry \cite{ref:Kelly2012}.
% Añadir cita que corrobore esto. De momento se queda la que hay.

Spectrum holders and regulators alike demand a higher level of protection for PU communications, and better incentives to accept coexistence with other users in their spectrum. In consequence, our\footnote{I will be using the first person plural by default throughout my thesis. Most of the ideas and work is a team effort involving my supervisor and other authors. This should not be considered as something that works against showing my autonomy, but even my personal decisions where strongly inspired by others' opinions. Meaningful research is not done (or should not be done) by a single person in a vacuum \cite{ref:Mihaly2013}. Thus, I consider artificial the use of singular forms here. In other parts of this thesis, such first person plural also includes the reader, primarily when describing mathematical derivations, as a natural way of walking him through the process.} \emph{motivation} in this thesis is, \emph{to develop dynamic spectrum access mechanisms focusing on the protection and creation of incentives to the PUs}. We directed our attention to the Opportunistic Spectrum Access framework, as it is more conservative regarding PU's protection with respect to other DSA approaches (such as the spectrum overlay and underlay models, consisting of concurrent transmissions of PUs and SUs), and to spectrum trading in our search for incentives.
Improvements in the Spectrum Commons Model are out of the scope of this thesis, since it removes property rights over spectrum and its challenges are significantly different.\footnote{There has been a long ongoing debate about whether such a drastic change of paradigm is convenient \cite{ref:Peha2005}, given the success witnessed in unlicensed bands (e.g. in the ISM band).}

More specifically, we set the following sub-objectives regarding unresolved issues in OSA: 
\begin{itemize}
\item Improving existing MAC protocols for hardware-constrained radios, specifically by considering the effect of the scanning delay on the information uncertainty (addressed in chapters \ref{BD_chap} and \ref{SPEC_MAN_chap}).
\item Allowing the secondary devices to better assess the impact of their activity on primary users' performance. The previous literature relied on OSA protocols design to keep PU performance above certain bounds that are heterogeneous in nature and difficult to assess in practice (chapters \ref{BD_chap} and \ref{RSM_chap}).
\item Exploring the options available to the primary operators for easing the coexistence with secondary devices (chapters \ref{BR_chap} and \ref{SPEC_MAN_chap}).
\item Proposing an application of OSA with practical interest to the telecommunications industry, and therefore motivating its adoption (chapter \ref{RSM_chap}).
\end{itemize}

With respect to the open challenges in spectrum trading, we pursued the following sub-goals:
\begin{itemize}
\item Providing an unified, structured and critic view of the existing solutions on this field, its specific challenges and open issues. An study with such a broad scope had not been done before (chapter \ref{Survey_chap}).
\item Balancing PUs' QoS with the economic revenue obtained by selling spectrum opportunities to SUs (chapter \ref{Sarnoff_chap}). 
\item Exploring mechanisms not based on monetary values. Most previous works are focused on economic transactions. However, other types of trades could add non-substitutable value such as trading spectrum opportunities in exchange for relay services (chapter \ref{MAB_CSSA_chap}).
\end{itemize}

We also have two common sub-objectives for OSA and spectrum trading:
\begin{itemize}
\item Dealing with imperfect information scenarios. That is, those for which some of the parameters of their stochastic models are not known or are not stationary (chapters \ref{RSM_chap} and \ref{MAB_CSSA_chap}). 
\item Keeping complexity low. The main tendency of previous (and contemporaneous) solutions in the area has been to propose increasingly complex models. Nonetheless, the resources, especially time, required to reach such elaborated solutions have not been considered enough.
\end{itemize}
% This last item pervades most of our proposed mechanisms.
% Previous works' trend was to deal with more  issues of DSA in more convoluted scenarios, aiming to solve them optimally and often neglecting computational and / or communication overhead.
% Nevertheless, multiple parameters in DSA experience rapid variations over time: spectrum availability, demand (unplanned peaks of traffic), valuation of the spectrum (changes in channel gains, mobility of entities), etc.
% In consequence, we believe that \emph{time consumption should be regarded as a key feature in DSA algorithms}: if obtaining an optimal solution takes so long that the system’s parameters vary significantly during the computation time, this solution may render inefficient. 
% In addition, the more time devoted to negotiation among the agents, the less time used in transmission. 
For that reason, it is more practical to design models that may not fully exploit spectrum in a particular moment (for example, by not taking into account spectrum geographical reuse) but that are capable of reducing the uncertainty due to the changes over time, and thus, providing higher guarantees on the agents’ benefit. 

% OSA 
% Para unos existe solo underlay y overlay (Zhao2007) y para otros interweave, underlay y overlay (Heng2012).

% SPECTRUM TRADING
% Among all mechanisms proposed to improve spectrum efficiency such as forced resource allocation algorithms, automated spectrum trading has the advantage of providing economic (and/or other) incentives to the entities involved, especially important to licensed operators, encouraging their cooperation and promoting motivation for future investments in primary spectrum acquisitions.

% Previous works in economic theory are not easily translated to spectrum trading because of the specific features of the traded good. A spectrum market poses the following addi- tional challenges:
% – Rapid variations with time
% – Imperfect information
% – Complex resource allocation considering re-utilization
% and heterogeneity of the good
% Both spectrum supply and demand changes are related to data traffic intensity which, in general, experiences rapid variations with time. In addition, spectrum characteristics are also highly variable, in particular, availability and channel quality parameters. This implies that the agents making the decisions in the spectrum markets have to be algorithmic. Automatic transactions are present in financial trading ([14]), but that market does not show the specific issues of spectrum trading.
% Imperfect information not only refers to the competitive behavior of agents in a traditional market, by which they are not willing to reveal their true valuation of a good. It also refers to the fact that agents may not have complete or reliable information about the market due to the communi- cation complexity that it would involve, specially in ad-hoc
% networks. It entails unfeasible requirements such as, for ex- ample, all entities knowing all channel gains between each other.
% Resource allocation becomes more complicated with spec- trum as a traded good because, depending on the mutual in- terference ranges of the entities, it can be spatially reused. It may also be considered that spectrum is an heterogeneous good, in the sense that the same spectrum portion can be valuated differently by each user, depending on its position, technology (spectrum efficiency use), etc.
% Rapid variations with time and resource allocation in complex models are tightly interrelated. Optimal resource allocation in complex models requires a computational time that makes it hard to keep up with the rapid changes, which, in turn, may render a solution inefficient because of a time dis-adaptation. Dealing with imperfect information makes optimal resource allocation more complex, even intractable. On the contrary, local estimations could be considered, sac- rificing model optimality for the sake of speed.

% OTROS
% ¿Por que consideramos siempre single radios?
% Regarding the field of applicability, we are focused on the issues at the link-layer of cognitive networks. 
% Incomplete information scenarios: those for which some of the parameters of its stochastic models are not known or are not stationary. 


\section{Contributions and Structure}

Our contribution can be divided into two main blocks, coincident with the structure of the thesis. 
Part \ref{part_OSA} features our contributions in the Opportunistic Spectrum Access framework.
This part is focused on protecting the PUs from interference caused by SUs access to spectrum, while trying to increase the spectrum usage efficiency. 
The most common approach in previous literature is to study the sensing and access from the SUs perspective, that is, focusing exclusively on the design of SU access protocols (independently if the works are addressing the impact on PUs or on SUs).
The original concept of cognitive radios, especially under an OSA approach, was to use such cognitive capabilities to make SUs access transparent (or as transparent as possible) to the PUs. 
However, we introduce the novel approach of allowing the primary network to adapt its resource allocation strategy in order to better coexist with cognitive devices. 

In particular, the contributions described in every chapter and publications are as follows.

\textbf{Chapter \ref{BD_chap}: Background Detection of Primary User Activity in Opportunistic Spectrum Access} \cite{ref:Alcaraz2015_BD}. 
We propose a collision detection mechanism for the SU, simultaneous to packet reception. 
Our proposal exploits local characterization of the PU activity, power levels and packet errors at each time slot. 
Based on these data, we develop a Maximum \textit{A Posteriori} (MAP) estimator as the basis for the collision detection system. We describe the general methodology to build this estimator, and study the system's robustness against parameter misestimations. 
The proposed scheme can be incorporated to existing OSA protocols. 
Our results show a notable throughput improvement for the SUs while assuring a lower collision probability with PU transmissions in most cases, even under severe estimation inaccuracies. 

\textbf{Chapter \ref{BR_chap}: Bandwidth Reservation as a Coexistence Strategy in Opportunistic Spectrum Access Environments} \cite{ref:Alcaraz2014_BR}. We study a bandwidth reservation (BR) scheme by which the primary network (PN) keeps a set of adjacent channels free of PU transmissions. 
These reserved channels only accommodate PU traffic when all the non-reserved channels are used, and the SUs only occupy available channels within the reserved spectrum.
From the point of view of the PN, BR entails a tradeoff between the benefits of an improved coexistence with SUs, and the capacity reduction associated to having fewer options for PU channel allocation.
The SUs are characterized by a hardware limited radio, imperfect spectrum sensing, bayesian estimation of PU activity and multichannel access. 
By means of a Markov-reward model, we compute the expected PU capacity with and without BR, considering propagation effects, interference and random locations.
The results show that, in a non-congested PN with SU activity, the interference reduction capability of BR increases the overall capacity of the PN compared to not using BR.

\textbf{Chapter \ref{SPEC_MAN_chap}: Uncertainty-Aware Opportunistic Spectrum Access in Coexistence - Friendly Systems} \cite{ref:Alcaraz2015_SPEC_MAN}.
This chapter comprises two main contributions: first we develop an optimal SU access strategy that considers the effect of delay in the uncertainty of the information available at the SUs. This effect has been largely ignored in the design of OSA protocols for hardware limited radios. Second, this OSA scheme is designed for coexistence-oriented scenarios (such as the bandwidth reservation of previous chapter), and evaluated under these conditions.
The formulation combines SU throughput and PU performance degradation, characterized by the overlapping time with SU activity.    
As most OSA protocols, our approach requires the SU to characterize the traffic profile of the PUs. The results of this chapter also illustrate the robustness of our approach to misestimation of PU traffic intensity.

\textbf{Chapter \ref{RSM_chap}. Response Surface Methodology for Efficient Spectrum Reuse in Cellular Networks} \cite{ref:Alcaraz2014_RSM,ref:Alcaraz2015_RSM}.
This chapter addresses one promising application of the OSA strategy: spectrum reuse of legacy access networks. As cellular network technology evolves, the operators deploy new generation networks while maintaining their legacy networks, since not all users upgrade their terminals at the same pace.
Therefore, the spectrum associated to these legacy networks becomes gradually underused.
By means of cognitive radio techniques, the operator can allow its new generation terminals to reuse this spectrum without any modification (and therefore any investment) on their legacy infrastructure.
We propose a semi-decentralized scheme in which a cellular operator guides the secondary access by broadcasting some operational parameters of the access strategy.
The mechanism dynamically learns the optimal parameters by means of a response surface methodology (RSM), implying a very small signalling overhead.
Our results show a notable capacity improvement compared to the classical approaches of exploiting spatial or temporal opportunities.

~\newline
Part \ref{part_auto} of the thesis contains our contributions in the field of automated spectrum trading. 
It is especially in this part where our low-complexity-intention has a greater significance, since the mainstream trend mostly neglects the importance of real-time adaptation, as chapter \ref{Survey_chap} shows. 
Our contributions in this topic can be summarized as follows:

\textbf{Chapter \ref{Survey_chap}. Automated spectrum trading mechanisms: understanding the big picture} \cite{ref:Mario2014}.
This work presents a general view of automated spectrum trading.
Our work is unique in its scope, focusing on automated spectrum trading as the most promising mechanism to solve spectrum scarcity.
We identify the specific aspects that make spectrum different from conventional goods and the impact that these features have on automatic trading.
We discuss past, current approaches and future research lines, highlighting their advantages and disadvantages. 
Each sub-topic is presented and developed explicitly with references to previous works where each aspect has been considered or addressed.
Finally, as a conclusion of the surveying effort, we highlight overlooked issues of automated spectrum trading, with a special focus on practical implementation.

\textbf{Chapter \ref{Sarnoff_chap} An MDP Framework for Centralized Dynamic Spectrum Leasing} \cite{ref:Alcaraz2012}.
This work addresses the design of centralized DSA MAC protocols comprising dynamic spectrum auction. We explore the possibilities of a formal design based on a Markov decision process (MDP) formulation. We propose a design framework to balance the grade-of-service (given by the blocking probability for PUs) and the expected economic revenue provided by the SUs' accepted bids. 
This trade-off can be managed in two ways. One consists of computing a single objective value given by a combination of the blocking probability and the expected revenue. 
The weights assigned to each objective determine the point in the Pareto front where the obtained policy lies. The other approach, consists of solving for one of the objectives and setting constraints on the remaining ones.
This chapter focuses on centralized trading in which we explore the use of MDP and CMDP formulations to balance benefit and grade of service for PUs. 
The main advantages of this approach is that it assures operating at global optimum and reduces the computational effort at SUs.

\textbf{Chapter \ref{MAB_CSSA_chap}. A superprocess with Upper Confidence Bounds for Cooperative Spectrum Sharing} \cite{ref:Mario2015_MAB_CSSA_1,ref:Mario2015_MAB_CSSA_2}. In this last chapter we focus on Cooperative Spectrum Sharing (CSS). CSS is is an appealing approach for primary networks to share spectrum with SUs because it increases the transmission range or rate of the PUs. Most previous works are focused on developing complex algorithms which may not be fast enough for real-time variations such as channel availability and/or assume perfect information about the network. Instead, we develop a learning mechanism for a primary network to enable CSS in a strongly incomplete information scenario with low computational overhead. Our mechanism is based on a Markovian variant of multi-armed bandits (MABs) called superprocess, enhanced with the concept of Upper Confidence Bound (UCB) from stochastic MABs. By means of Monte-Carlo simulations we show that, despite its low computational overhead, it converges to the optimal solution and outperforms baseline approaches such as $\epsilon$-greedy. This algorithm can be extended to include more sophisticated features while maintaining its desirable properties such as low computational overhead and fast speed of convergence. 

\section{Methodology}
\begin{table}
\small
\rowcolors{1}{}{lightgray}
\begin{tabular}{C{1.7cm}C{7cm}C{4.7cm}} \hline
\textbf{Chapters} & \textbf{Tools used by proposed mechanisms} & \textbf{Numerical Evaluation}\\\hline
2 & Statistical inference, MRM, discrete optimization & MRM, Monte-Carlo sim.\\
3 & MRM & Stochastic model, MRM, Monte-Carlo sim.\\
4 & POMDP & MRM \\
5 & Stochastic optimization (RSM) & Monte-Carlo sim.\\
7 & CMDP & MRM \\
8 & Reinforcement learning (MABs), MDP & Monte-Carlo sim. \\\hline
\end{tabular}

% \begin{tabular}{|m{5cm}|H{3.5cm}|H{3.5cm}|} \hline
% \textbf{Chapters} & \textbf{Tools used by proposed mechanisms} & \textbf{Numerical Evaluation}\\\hline
% Background Detection of Primary User Activity in Opportunistic Spectrum Access & Statistical inference,\newline MDP & DTMC,\newline Monte-Carlo sim.\\\hline
% Bandwidth Reservation as a Coexistence Strategy in Opportunistic Spectrum Access Environments & - & Stochastic model, DTMC, Monte-Carlo sim.\\\hline
% On the Impact of Licensed Users Management on the Efficiency of Opportunistic Spectrum Access
%  & POMDP & DTMC \\\hline
% Response Surface Methodology for Efficient Spectrum Reuse in Cellular Networks & Stochastic optimization (RSM) & Monte-Carlo sim.\\\hline
% An MDP Framework for Centralized Dynamic Spectrum Auction & CMDP & DTMC \\\hline
% A superprocess with Upper Confidence Bounds for Cooperative Spectrum Sharing & Reinforcement learning (MABs),\newline MDP & Monte-Carlo sim. \\\hline
% \end{tabular}
\centering
\caption{Relation of mathematical tools and thesis chapters}
\label{intro_table_math_tools}
\end{table}
This thesis is part of the project \enquote{ChAracterization, EvaLuation, Planning and IMprovement of Key Technologies for the Future Internet: Knowledge and Transfer (CALM)}, funded by the Spanish Ministry of Economy and Competitiveness. 
The CALM project is organized as a set of objectives interrelating key technologies for the Future Internet, \emph{with a special focus on mathematical tools} for the development, analysis and improvement of networks and protocols.

Most of our proposed coexistence mechanisms and policies in this thesis are grounded in Markov Decision Processes (MDPs) \cite{ref:Puterman2005}. 
The suitability of this tool for our scenario is straightforward to see: Markov models \enquote{are applicable to any dynamic system whose evolution over time involves uncertainty} \cite{ref:Bertsekas2012}, as is the case of spectrum occupancy over time. 
The constrained-MDP (CMDP) formulated in chapter \ref{Sarnoff_chap}, and the Partially Observable MDP (POMDP) in chapter \ref{SPEC_MAN_chap}, are especially remarkable because of their far-from-common presence in previous DSA works. 

Trying to characterize incomplete information scenarios, by taking into account all the possible values of the (often continuous) unknown parameters, is computationally infeasible with MDPs. 
This is known as \enquote{the curse of dimensionality} \cite{ref:Powell2012}. 
In the chapters devoted to these scenarios, we resort to reinforcement learning and stochastic optimization approaches. 
Some of the tools used in this thesis like Response Surface Methodology (RSM) (chapter \ref{RSM_chap}) or Multi-Armed bandits (MABs) (chapter \ref{MAB_CSSA_chap}) are of new applicability to coexistence issues in cognitive radio and are becoming hot topics, not only in the research community \cite{ref:Bkassiny2013} but also in highly profitable businesses like online advertisement \cite{ref:White2012}. 

Regarding the analysis and numerical evaluation of our mechanisms, we used Markov Reward Models (MRM). Either accompanying the previous tool or as the main performance evaluation resource, we resorted to the simple but powerful concept of Monte-Carlo simulation.

We rely on well-known stochastic models of the different real world parameters of interest, such as the Poisson traffic model, the log-normal distribution to describe shadow fading, etc. Such models have been widely used and validated in previous literature \cite{ref:Goldsmith2005}

Because of our focus in algorithms and the link layer of cognitive networks, a characterization involving a full-protocol stack or a deep modeling of physical effects is not needed. Therefore, regarding the software support, we mainly worked with MATLAB \cite{ref:MATLAB}, Mathematica \cite{ref:Mathematica} for some mathematical derivations, and the OMNeT\verb!++! simulator \cite{ref:Omnet} in the particular case of chapter \ref{BR_chap} (used for numerical evaluation). We have also employed other development platforms such as Python with SciPy \cite{ref:SciPy} and R \cite{ref:RStudio}, because of their suitability for machine learning applications and data analysis.



